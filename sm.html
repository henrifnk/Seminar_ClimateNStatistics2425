<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 DL Classification of Weather Patterns over Europe | Climate And Statistics</title>
  <meta name="description" content="A Seminar about statistical methods in climate research in WS24/25." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 DL Classification of Weather Patterns over Europe | Climate And Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A Seminar about statistical methods in climate research in WS24/25." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 DL Classification of Weather Patterns over Europe | Climate And Statistics" />
  
  <meta name="twitter:description" content="A Seminar about statistical methods in climate research in WS24/25." />
  

<meta name="author" content="Henri Funk, Alexander Sasse, Helmut Küchenhoff, Ralf Ludwig" />


<meta name="date" content="2025-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="causal-discovery---constrain-uncertainties-in-climate-projections.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Climate and Statistics II</li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#technical-setup"><i class="fa fa-check"></i>Technical Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="sm.html"><a href="sm.html"><i class="fa fa-check"></i><b>1</b> DL Classification of Weather Patterns over Europe</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sm.html"><a href="sm.html#abstract"><i class="fa fa-check"></i><b>1.1</b> Abstract</a></li>
<li class="chapter" data-level="1.2" data-path="sm.html"><a href="sm.html#introduction"><i class="fa fa-check"></i><b>1.2</b> Introduction</a></li>
<li class="chapter" data-level="1.3" data-path="sm.html"><a href="sm.html#data"><i class="fa fa-check"></i><b>1.3</b> Data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sm.html"><a href="sm.html#data-sources"><i class="fa fa-check"></i><b>1.3.1</b> Data Sources</a></li>
<li class="chapter" data-level="1.3.2" data-path="sm.html"><a href="sm.html#data-preprocessing-steps"><i class="fa fa-check"></i><b>1.3.2</b> Data Preprocessing Steps</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sm.html"><a href="sm.html#models-and-training"><i class="fa fa-check"></i><b>1.4</b> Models and Training</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sm.html"><a href="sm.html#cnn-architecture"><i class="fa fa-check"></i><b>1.4.1</b> CNN Architecture</a></li>
<li class="chapter" data-level="1.4.2" data-path="sm.html"><a href="sm.html#training-protocol"><i class="fa fa-check"></i><b>1.4.2</b> Training Protocol</a></li>
<li class="chapter" data-level="1.4.3" data-path="sm.html"><a href="sm.html#predicting-technique"><i class="fa fa-check"></i><b>1.4.3</b> Predicting Technique</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sm.html"><a href="sm.html#results"><i class="fa fa-check"></i><b>1.5</b> Results</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sm.html"><a href="sm.html#classification-performance"><i class="fa fa-check"></i><b>1.5.1</b> Classification Performance</a></li>
<li class="chapter" data-level="1.5.2" data-path="sm.html"><a href="sm.html#signature-plot-analysis"><i class="fa fa-check"></i><b>1.5.2</b> Signature Plot Analysis</a></li>
<li class="chapter" data-level="1.5.3" data-path="sm.html"><a href="sm.html#frequency-distribution-of-hb-cts"><i class="fa fa-check"></i><b>1.5.3</b> Frequency Distribution of HB CTs</a></li>
<li class="chapter" data-level="1.5.4" data-path="sm.html"><a href="sm.html#future-change"><i class="fa fa-check"></i><b>1.5.4</b> Future Change</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sm.html"><a href="sm.html#conclusion-and-outlook"><i class="fa fa-check"></i><b>1.6</b> Conclusion and Outlook</a></li>
<li class="chapter" data-level="1.7" data-path="sm.html"><a href="sm.html#appendix"><i class="fa fa-check"></i><b>1.7</b> Appendix</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="sm.html"><a href="sm.html#statement"><i class="fa fa-check"></i><b>1.7.1</b> Statement</a></li>
<li class="chapter" data-level="1.7.2" data-path="sm.html"><a href="sm.html#figures"><i class="fa fa-check"></i><b>1.7.2</b> Figures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html"><i class="fa fa-check"></i><b>2</b> Causal Discovery - Constrain uncertainties in climate projections</a>
<ul>
<li class="chapter" data-level="2.1" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#abstract-1"><i class="fa fa-check"></i><b>2.1</b> Abstract</a></li>
<li class="chapter" data-level="2.2" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#introduction-to-climate-models"><i class="fa fa-check"></i><b>2.2</b> Introduction to climate models</a></li>
<li class="chapter" data-level="2.3" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#process"><i class="fa fa-check"></i><b>2.3</b> Process</a></li>
<li class="chapter" data-level="2.4" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#statistical-background"><i class="fa fa-check"></i><b>2.4</b> Statistical background</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#principal-component-analysis-and-varimax-rotation"><i class="fa fa-check"></i><b>2.4.1</b> Principal Component Analysis and Varimax Rotation</a></li>
<li class="chapter" data-level="2.4.2" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#pcmci-algorithm-technical-implementation"><i class="fa fa-check"></i><b>2.4.2</b> PCMCI Algorithm Technical Implementation</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#results-1"><i class="fa fa-check"></i><b>2.5</b> Results</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#spatial-patterns-of-rotated-components"><i class="fa fa-check"></i><b>2.5.1</b> Spatial Patterns of Rotated Components</a></li>
<li class="chapter" data-level="2.5.2" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#causal-network"><i class="fa fa-check"></i><b>2.5.2</b> Causal Network</a></li>
<li class="chapter" data-level="2.5.3" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#high-variance-component-networks"><i class="fa fa-check"></i><b>2.5.3</b> High-Variance Component Networks</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#limitations"><i class="fa fa-check"></i><b>2.6</b> Limitations</a></li>
<li class="chapter" data-level="2.7" data-path="causal-discovery---constrain-uncertainties-in-climate-projections.html"><a href="causal-discovery---constrain-uncertainties-in-climate-projections.html#conclusions"><i class="fa fa-check"></i><b>2.7</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ce.html"><a href="ce.html"><i class="fa fa-check"></i><b>3</b> Cold Extremes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ce.html"><a href="ce.html#abstract-2"><i class="fa fa-check"></i><b>3.1</b> Abstract</a></li>
<li class="chapter" data-level="3.2" data-path="ce.html"><a href="ce.html#introduction-and-geographic-background"><i class="fa fa-check"></i><b>3.2</b> Introduction and Geographic Background</a></li>
<li class="chapter" data-level="3.3" data-path="ce.html"><a href="ce.html#data-processing"><i class="fa fa-check"></i><b>3.3</b> Data processing</a></li>
<li class="chapter" data-level="3.4" data-path="ce.html"><a href="ce.html#methods"><i class="fa fa-check"></i><b>3.4</b> Methods</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ce.html"><a href="ce.html#dynamical-adjustment-using-elastic-net-regression"><i class="fa fa-check"></i><b>3.4.1</b> Dynamical Adjustment using Elastic Net Regression</a></li>
<li class="chapter" data-level="3.4.2" data-path="ce.html"><a href="ce.html#ensemble-boosting"><i class="fa fa-check"></i><b>3.4.2</b> Ensemble Boosting</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ce.html"><a href="ce.html#results-and-discussion"><i class="fa fa-check"></i><b>3.5</b> Results and Discussion</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ce.html"><a href="ce.html#results-from-dynamical-adjustment"><i class="fa fa-check"></i><b>3.5.1</b> Results from Dynamical Adjustment</a></li>
<li class="chapter" data-level="3.5.2" data-path="ce.html"><a href="ce.html#results-from-ensemble-boosting"><i class="fa fa-check"></i><b>3.5.2</b> Results from Ensemble Boosting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html"><i class="fa fa-check"></i><b>4</b> Flood Frequency Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#abstract-3"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="4.1" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="sm.html"><a href="sm.html#data"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="ce.html"><a href="ce.html#methods"><i class="fa fa-check"></i><b>4.3</b> Methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#cops"><i class="fa fa-check"></i><b>4.3.1</b> Copulas</a></li>
<li class="chapter" data-level="4.3.2" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#sklarstheorem"><i class="fa fa-check"></i><b>4.3.2</b> Sklar’s Theorem</a></li>
<li class="chapter" data-level="4.3.3" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#archcops"><i class="fa fa-check"></i><b>4.3.3</b> Symmetric Archimedean copulas and generator functions</a></li>
<li class="chapter" data-level="4.3.4" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#taildep"><i class="fa fa-check"></i><b>4.3.4</b> Taildependence and Rotation</a></li>
<li class="chapter" data-level="4.3.5" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#nacs"><i class="fa fa-check"></i><b>4.3.5</b> Fully Nested Archimedean copulas</a></li>
<li class="chapter" data-level="4.3.6" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#vines"><i class="fa fa-check"></i><b>4.3.6</b> Vine Copulas</a></li>
<li class="chapter" data-level="4.3.7" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#est"><i class="fa fa-check"></i><b>4.3.7</b> Estimation and Selection Process</a></li>
<li class="chapter" data-level="4.3.8" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#gev"><i class="fa fa-check"></i><b>4.3.8</b> Identifying univariate margins</a></li>
<li class="chapter" data-level="4.3.9" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#kendallstau"><i class="fa fa-check"></i><b>4.3.9</b> Kendall’s <span class="math inline">\(\tau\)</span></a></li>
<li class="chapter" data-level="4.3.10" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#software"><i class="fa fa-check"></i><b>4.3.10</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#sim"><i class="fa fa-check"></i><b>4.4</b> Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#app"><i class="fa fa-check"></i><b>4.5</b> Application</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#goodness-of-fit"><i class="fa fa-check"></i><b>4.5.1</b> Goodness of Fit</a></li>
<li class="chapter" data-level="4.5.2" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#fitted-tail-dependencies"><i class="fa fa-check"></i><b>4.5.2</b> Fitted Tail Dependencies</a></li>
<li class="chapter" data-level="4.5.3" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#event-probability"><i class="fa fa-check"></i><b>4.5.3</b> Event Probability</a></li>
<li class="chapter" data-level="4.5.4" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#model-comparison"><i class="fa fa-check"></i><b>4.5.4</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="flood-frequency-analysis.html"><a href="flood-frequency-analysis.html#conclusion"><i class="fa fa-check"></i><b>4.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>5</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-1.html"><a href="introduction-1.html#intro-about-the-seminar-topic"><i class="fa fa-check"></i><b>5.1</b> Intro About the Seminar Topic</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-1.html"><a href="introduction-1.html#outline-of-the-booklet"><i class="fa fa-check"></i><b>5.2</b> Outline of the Booklet</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html"><i class="fa fa-check"></i><b>6</b> Co-occurence of extremes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#abstract-4"><i class="fa fa-check"></i><b>6.1</b> Abstract</a></li>
<li class="chapter" data-level="6.2" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#introduction-2"><i class="fa fa-check"></i><b>6.2</b> Introduction</a></li>
<li class="chapter" data-level="6.3" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#tail-dependence"><i class="fa fa-check"></i><b>6.3</b> Tail Dependence</a></li>
<li class="chapter" data-level="6.4" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#hypothesis-test"><i class="fa fa-check"></i><b>6.4</b> Hypothesis Test</a></li>
<li class="chapter" data-level="6.5" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#probability-multiple-factor"><i class="fa fa-check"></i><b>6.5</b> Probability Multiple Factor</a></li>
<li class="chapter" data-level="6.6" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#results-2"><i class="fa fa-check"></i><b>6.6</b> Results</a></li>
<li class="chapter" data-level="6.7" data-path="co-occurence-of-extremes.html"><a href="co-occurence-of-extremes.html#sensitivity-test"><i class="fa fa-check"></i><b>6.7</b> Sensitivity Test</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-3.html"><a href="introduction-3.html"><i class="fa fa-check"></i><b>7</b> Introduction</a></li>
<li class="chapter" data-level="8" data-path="introduction-4.html"><a href="introduction-4.html"><i class="fa fa-check"></i><b>8</b> 1 Introduction</a></li>
<li class="chapter" data-level="9" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>9</b> 2 Background</a>
<ul>
<li class="chapter" data-level="9.1" data-path="background.html"><a href="background.html#climate-and-public-health"><i class="fa fa-check"></i><b>9.1</b> 2.1 Climate and Public Health</a></li>
<li class="chapter" data-level="9.2" data-path="background.html"><a href="background.html#related-literature"><i class="fa fa-check"></i><b>9.2</b> 2.2 Related Literature</a></li>
<li class="chapter" data-level="9.3" data-path="background.html"><a href="background.html#splines"><i class="fa fa-check"></i><b>9.3</b> 3.1 Splines</a></li>
<li class="chapter" data-level="9.4" data-path="background.html"><a href="background.html#generalized-additive-models-gam"><i class="fa fa-check"></i><b>9.4</b> 3.2 Generalized Additive Models (GAM)</a></li>
<li class="chapter" data-level="9.5" data-path="background.html"><a href="background.html#gradient-boosting"><i class="fa fa-check"></i><b>9.5</b> 3.3 Gradient Boosting</a></li>
<li class="chapter" data-level="9.6" data-path="background.html"><a href="background.html#xgboost"><i class="fa fa-check"></i><b>9.6</b> 3.4 XGBoost</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="background.html"><a href="background.html#modeling-high-dimensional-climate-health-data"><i class="fa fa-check"></i><b>9.6.1</b> 3.4.1 Modeling High-Dimensional Climate-Health Data</a></li>
<li class="chapter" data-level="9.6.2" data-path="background.html"><a href="background.html#greedy-feature-selection"><i class="fa fa-check"></i><b>9.6.2</b> 3.4.2 Greedy Feature Selection</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="background.html"><a href="background.html#lag-effects-and-crossbasis-function"><i class="fa fa-check"></i><b>9.7</b> 3.5 Lag Effects and CrossBasis Function</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>10</b> 4 Application</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application.html"><a href="application.html#heat-related-mortality"><i class="fa fa-check"></i><b>10.1</b> 4.1 Heat-related mortality</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="application.html"><a href="application.html#data-description-and-modeling-approach"><i class="fa fa-check"></i><b>10.1.1</b> 4.1.1 Data Description and Modeling Approach</a></li>
<li class="chapter" data-level="10.1.2" data-path="application.html"><a href="application.html#result"><i class="fa fa-check"></i><b>10.1.2</b> 4.1.2 result</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="application.html"><a href="application.html#west-nile-virus"><i class="fa fa-check"></i><b>10.2</b> 4.2 West Nile Virus</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="application.html"><a href="application.html#data-and-method"><i class="fa fa-check"></i><b>10.2.1</b> 4.2.1 Data and Method</a></li>
<li class="chapter" data-level="10.2.2" data-path="application.html"><a href="application.html#results-3"><i class="fa fa-check"></i><b>10.2.2</b> 4.2.2 Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conclusion-1.html"><a href="conclusion-1.html"><i class="fa fa-check"></i><b>11</b> 5.Conclusion</a></li>
<li class="chapter" data-level="12" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>12</b> Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Climate And Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sm" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> DL Classification of Weather Patterns over Europe<a href="sm.html#sm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Author: Ziyu Mu, Laura Schlueter</em></p>
<p><em>Supervisor: Henri Funk</em></p>
<p><em>Degree: Master</em></p>
<div id="abstract" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Abstract<a href="sm.html#abstract" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Daily weather in the mid-latitudes is dominated by large-scale atmospheric circulation types (CTs), which influence regional climate variability and extremes.
Accurate classification of these CTs is crucial for diagnosing long-term climate dynamics and analysing future changes. This study implements and extends a novel deep learning-based classification method for European CTs, building on the Hess &amp; Brezowsky (HB) framework.</p>
<p>Using a convolutional neural network (CNN) architecture (inspired by applications in climate science and optimization techniques from), we trained the model on high-resolution ERA5 reanalysis data (1950–1980), with sea-level pressure (SLP) and geopotential height at 500 hPa (z500) fields as key predictors. To ensure robustness, a nested cross-validation approach was employed, achieving an overall accuracy of 53.17% and a macro F1 score of 55.14%, outperforming traditional classification methods.</p>
<p>Applied to the CanESM2 ensemble projections, which simulate data with assumptions that climate conditions were consistent with history, our results show significant future frequency shifts in CTs, notably an increase in Icelandic High, Cyclonic (HNZ) occurrences during both summer and winter half-years. This methodological advancement not only enhances classification accuracy but also offers robust ensemble analyses critical for climate-informed decision-making.</p>
</div>
<div id="introduction" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Introduction<a href="sm.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the mid latitudes, daily weather is dominated by large-scale atmospheric circulation patterns,
defined by the position of high and low pressure centres <span class="citation">(<a href="#ref-Hackel2021">Häckel 2021</a>; <a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
Due to steep temperature and pressure gradients along the frontal zone between polar and tropical air masses (around 45° latitude),
the jet stream is formed in about 10 km altitude.
It is characterized by mean wind speeds of 300 km/h and the long-term average wind direction is westerly <span class="citation">(<a href="#ref-Hackel2021">Häckel 2021</a>)</span>.
Here, dynamic high and low pressure systems develop <span class="citation">(<a href="#ref-Hackel2021">Häckel 2021</a>; <a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
However, the westerly jet stream is not stationary, but deflected with varying amplitude creating the so-called Rossby waves,
which influence the position of high and low pressure systems <span class="citation">(<a href="#ref-Hackel2021">Häckel 2021</a>)</span>.
While an infinite number of atmospheric conditions would be conceivable, recurrent weather patterns with similar meteorological features are observed in practice.
Therefore, it is possible to classify weather patterns according to synoptic properties <span class="citation">(<a href="#ref-Bissolli2001b">Bissolli 2001</a>)</span>.</p>
<p>The first concept for a classification of different weather patterns was introduced by <span class="citation">Baur, Hess, and Nagel (<a href="#ref-Baur1944">1944</a>)</span>.
They used surface pressure charts from 1881 to 1939 and assigned the respective weather situation to a specific class for each day based on the spatial distribution of atmospheric pressure and the position of the frontal zones.
This lead to a classification into 21 Grosswetterlagen for Europe and East Atlantic <span class="citation">(<a href="#ref-Baur1944">Baur, Hess, and Nagel 1944</a>)</span>.
In 1963 Baur defined Grosswetterlage as the mean spatial air pressure distribution of a large area, at least the size of Europe, over a period of several successive days.
This classification has been revised and improved several times. In 1977, Hess and Brezowsky published their third edition of a revised catalogue of Grosswetterlagen.
Here, the authors determined that a Grosswetterlage should only be classified if it can be recognised on at least three successive days.
Furthermore, the number was extended to 29 different Grosswetterlagen.
In addition to the surface pressure chart, the classification was also based on the geopotential height in 500hPa <span class="citation">(<a href="#ref-Bissolli2001">Bissolli and Dittmann 2001</a>; <a href="#ref-Bissolli2001b">Bissolli 2001</a>; <a href="#ref-Werner2010">Werner and Gerstengarbe 2010</a>)</span>.
In the following, Werner and Gerstengarbe published seven editions of a catalogue of the Grosswetterlagen in Europe with updated data.
The last edition (2010) covers the years 1881 to 2009 and provides daily information on the Grosswetterlage over Europe.
Today, the German Weather Service (DWD) still constantly updates the catalogue of European Grosswetterlagen and publishes the results monthly.
Since 1944, the classification of Grosswetterlagen is conducted by experts, hence it is subjectively biased <span class="citation">(<a href="#ref-Hess2005katalog">Hess 2005</a>)</span>.
In the following, the classification according to Hess &amp; Brezwosky will be referred to as HB CT.</p>
<p>HB CTs can be attributed to certain weather situation at certain locations in Europe <span class="citation">(<a href="#ref-Werner2010">Werner and Gerstengarbe 2010</a>)</span>.
Hence in the past, the classification of HB CTs has been used to identify regularities in frequency and duration of occurrences of certain weather conditions.
<span class="citation">Bissolli and Dittmann (<a href="#ref-Bissolli2001">2001</a>)</span> describes a relationship between frequency and duration of the HB CTs and mean annual air temperature and precipitation.
Moreover, extreme weather events—such as heavy rainfall, floods, and heat waves—can often be linked to specific HB CTs <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
Such kinds of application could not only be useful to analyse past climate.
Future climate projections could also be analysed using the HB CTs, allowing conclusions to be drawn about future developments.
However, analyzing future CTs requires many model ensembles to account for internal variability <span class="citation">(<a href="#ref-Wyser2021">Wyser et al. 2021</a>)</span>.
Manual classification of HB CTs for many ensemble members is no longer possible.
It is therefore necessary to consider the possibility of automatization <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
<span class="citation">Mittermeier et al. (<a href="#ref-Mittermeier2022">2022</a>)</span> have found a way to classify HB CTs automatically using a deep learning classifier.</p>
</div>
<div id="data" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Data<a href="sm.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-sources" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Data Sources<a href="sm.html#data-sources" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section describes in detail the datasets utilized for model training, validation, and testing,
providing comprehensive explanations of their characteristics, purposes, and roles within the study.
Due to data availability constraints, we replaced the original study’s ERA-20C <span class="citation">(<a href="#ref-Poli2016">Poli et al. 2016</a>)</span> and SMHI-LENS <span class="citation">(<a href="#ref-Wyser2021">Wyser et al. 2021</a>)</span> data with
ERA5 <span class="citation">(<a href="#ref-ECMWF_ERA5">European Centre for Medium-Range Weather Forecasts 2017</a>)</span> (higher resolution, 1950–1980) for training and CanESM2 <span class="citation">(<a href="#ref-Hua2015">Hua et al. 2015</a>; <a href="#ref-CanESM2">Government of Canada 2025</a>)</span> (use only 12 of 50 ensemble members) for projections.</p>
<div id="historical-data---training-and-validation" class="section level4 hasAnchor" number="1.3.1.1">
<h4><span class="header-section-number">1.3.1.1</span> Historical Data - Training and Validation<a href="sm.html#historical-data---training-and-validation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We use reanalysis dataset, which is the historical atmospheric data reconstructed by combining observational data and model simulations, for training and validation.
Data is provided by European Centre for Medium-Range Weather Forecasts (ECMWF).</p>
<p>We only use two variables mentioned above:</p>
<ol style="list-style-type: decimal">
<li>SLP: Atmospheric pressure measured at Earth’s surface, vital for identifying weather systems such as cyclones and anticyclones.</li>
<li>z500: Height of the 500 hPa pressure level in the atmosphere, indicative of atmospheric wave patterns and mid-tropospheric dynamics.</li>
</ol>
<p>Due to reanalysis data’s high-quality, accurate, and detailed historical atmospheric representation, it is enabled to get a robust and precise training of the deep learning model.</p>
<p>The difference of ERA5 (Figure <a href="sm.html#fig:ERA5">1.1</a>) and ERA-20C (Appendix Figure <a href="sm.html#fig:ERA20C">1.7</a>) lies on:</p>
<table>
<caption>Difference between two reanalysis dataset</caption>
<colgroup>
<col width="36%" />
<col width="25%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Reanalysis Dataset</th>
<th align="left">Temporal Coverage</th>
<th align="left">Spatial Resolution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ERA-20C (paper)</td>
<td align="left">1900–1980</td>
<td align="left">Approximately 125 km</td>
</tr>
<tr class="even">
<td align="left">ERA5 (implementation)</td>
<td align="left">1950–1980</td>
<td align="left">High-resolution, about 31 km</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ERA5"></span>
<img src="work/01-weatherpattern/figures/circulation_types_regrid.png" alt="Synoptic patterns of the 29 HB CTs created using ERA5 data averaged over the period 1950 - 1980, showing SLP on the left and z500 on the right side." width="70%" />
<p class="caption">
FIGURE 1.1: Synoptic patterns of the 29 HB CTs created using ERA5 data averaged over the period 1950 - 1980, showing SLP on the left and z500 on the right side.
</p>
</div>
</div>
<div id="future-climate-projections---change-analysis" class="section level4 hasAnchor" number="1.3.1.2">
<h4><span class="header-section-number">1.3.1.2</span> Future Climate Projections - Change Analysis<a href="sm.html#future-climate-projections---change-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We use ensemble datasets which projected future climate conditions under specific scenarios,
to evaluate future changes in atmospheric circulation, considering internal variability,
essential for accurate and reliable climate change projections.
The data should be preprocessed with the same variables, scale, domain, resolution as training data.</p>
<ol style="list-style-type: decimal">
<li>CanESM2 <span class="citation">(<a href="#ref-CanESM2">Government of Canada 2025</a>)</span>
<ul>
<li>Name: CanESM2 (Canadian Earth System Model version 2)</li>
<li>Provider: Canadian Centre for Climate Modelling and Analysis (CCCma)</li>
<li>Model Used: Climate Model Intercomparison Project phase 5 (CMIP5)</li>
<li>Ensemble Members: 50 (due to downloading limitation, we only used 12 ensemble)</li>
<li>Scenario: historical, simulate the condition as observed past climate from 1850 to at least 2005 <span class="citation">(<a href="#ref-Friedlingstein2008">Friedlingstein et al. 2008</a>)</span>.</li>
<li>Temporal Coverage:
<ul>
<li>Historical Reference: 1971–2000</li>
<li>Future Projections: 2031–2060</li>
</ul></li>
<li>Spatial Resolution: Around 2.8°</li>
</ul></li>
<li>SMHI-LENS <span class="citation">(<a href="#ref-Wyser2021">Wyser et al. 2021</a>)</span>
<ul>
<li>Name: SMHI-LENS (Swedish Meteorological and Hydrological Institute Large Ensemble)</li>
<li>Provider: Swedish Meteorological and Hydrological Institute</li>
<li>Model Used: EC-Earth3 (Climate Model Intercomparison Project phase 6, CMIP6)</li>
<li>Ensemble Members: 50 (to effectively capture internal variability)</li>
<li>Scenario: SSP3-RCP7.0, representing a high GHG emission pathway</li>
<li>Temporal Coverage:
<ul>
<li>Historical Reference: 1991–2020</li>
<li>Future Projections: 2071–2100</li>
</ul></li>
<li>Spatial Resolution: Around 0.7°</li>
</ul></li>
</ol>
<p>As a result with higher greenhouse gas emission under SSP3-RCP7.0 scenario, and with a more distant future in the paper:</p>
<ol style="list-style-type: decimal">
<li>Future warming and circulation shifts might be more pronounced than our implementation.</li>
<li>Frequency changes in HB CTs may appear larger in the paper, simply because the climate change signal is stronger.</li>
</ol>
</div>
</div>
<div id="data-preprocessing-steps" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Data Preprocessing Steps<a href="sm.html#data-preprocessing-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Reset spatial domain: only use data in Europe and the North Atlantic region (30°N–75°N latitude, 65°W–45°E longitude)</li>
<li>Spatial Regridding: All datasets were interpolated to a common 5° grid resolution, ensuring consistency and computational efficiency</li>
<li>Seasonal Centering: Applied to remove seasonal biases, helping the model better recognize atmospheric patterns independently of seasonal influences.</li>
</ol>
</div>
</div>
<div id="models-and-training" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Models and Training<a href="sm.html#models-and-training" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cnn-architecture" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> CNN Architecture<a href="sm.html#cnn-architecture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The classification model used in this study is based on a CNN,
specifically designed to handle the image-like structure of atmospheric data (SLP and z500).
The CNN architecture (Figure <a href="sm.html#fig:network">1.2</a>) comprises:</p>
<ol style="list-style-type: decimal">
<li>Input Layer: Two separate input channels corresponding to SLP and z500.</li>
<li>Convolutional Layers: Two convolutional layers applied to extract spatial patterns and features from input atmospheric fields. These layers use convolutional kernels to identify local and spatially coherent patterns.</li>
<li>Dropout Layer: Included for regularization to mitigate overfitting by randomly dropping out units during training, thus improving the model’s generalization.</li>
<li>Fully Connected Layers: Two fully connected layers following the convolutional and dropout layers, used for integrating learned spatial features into final predictions of HB CTs.</li>
<li>Output Layer: Outputs softmax probabilities for each of the 29 HB CTs, which are then converted into classifications.</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:network"></span>
<img src="work/01-weatherpattern/figures/network.png" alt="Schematic diagram of the CNN network" width="70%" />
<p class="caption">
FIGURE 1.2: Schematic diagram of the CNN network
</p>
</div>
</div>
<div id="training-protocol" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Training Protocol<a href="sm.html#training-protocol" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="adam-optimizer" class="section level4 hasAnchor" number="1.4.2.1">
<h4><span class="header-section-number">1.4.2.1</span> Adam Optimizer<a href="sm.html#adam-optimizer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Adam (Adaptive Moment Estimation) <span class="citation">(<a href="#ref-Mehta2019">Mehta, Paunwala, and Vaidya 2019</a>)</span> is an optimization algorithm widely used for training neural networks.
It combines the benefits of two other methods—AdaGrad <span class="citation">(<a href="#ref-Ward2020">Ward, Wu, and Bottou 2020</a>)</span>, which adapts the learning rate for each parameter,
and RMSProp <span class="citation">(<a href="#ref-Zou2019">F. Zou et al. 2019</a>)</span>, which considers the exponentially decaying average of squared gradients—to adjust the learning rates adaptively during training.</p>
<p>Adam optimizer efficiently handles noisy and sparse gradients, common in deep learning tasks,
facilitating faster convergence and better handling of large parameter spaces typical of CNNs.
This makes Adam particularly suitable for our CNN-based classification model, ensuring effective and efficient training.</p>
</div>
<div id="bayesian-optimization-for-hyperparameter-tuning" class="section level4 hasAnchor" number="1.4.2.2">
<h4><span class="header-section-number">1.4.2.2</span> Bayesian Optimization for Hyperparameter Tuning<a href="sm.html#bayesian-optimization-for-hyperparameter-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To achieve an optimal configuration of hyperparameters for our CNN, we employed Bayesian optimization <span class="citation">(<a href="#ref-Garnett2023">Garnett 2023</a>)</span>,
specifically using the Tree-structured Parzen Estimator (TPE) method <span class="citation">(<a href="#ref-Ozaki2022">Ozaki et al. 2022</a>)</span> implemented in the Optuna library.
Bayesian optimization is particularly suited for deep learning hyperparameter tuning due to its efficiency and ability to intelligently balance exploration and exploitation of the hyperparameter space, thus significantly reducing computational cost compared to grid or random search.</p>
<p>Specifically, the following hyperparameters were optimized:</p>
<ol style="list-style-type: decimal">
<li>Learning Rate:
The learning rate controls the magnitude of updates to the network weights during training. We allowed this hyperparameter to vary logarithmically between <span class="math inline">\(10^{-4}\)</span> and <span class="math inline">\(10^{-2}\)</span>, enabling the optimizer to effectively explore both subtle and more substantial updates in network parameters.</li>
<li>Weight Decay:
Serving as a regularization term to prevent overfitting, the weight decay was also sampled on a logarithmic scale ranging from <span class="math inline">\(10^{-5}\)</span> to <span class="math inline">\(10^{-3}\)</span>. This enabled fine control over model complexity and encouraged better generalization.</li>
<li>Dropout Rate:
Dropout prevents overfitting by randomly dropping neurons during training, forcing the model to learn robust representations. We tuned dropout rate uniformly within a range from 0.2 to 0.6, allowing optimization of the model’s regularization intensity.</li>
<li>Convolutional Layer Parameters:
<ul>
<li>Number of Output Channels in First Convolutional Layer (out_channels1):
Chosen categorically from [4, 8, 16], optimizing the depth and feature extraction capability of initial convolutional operations.</li>
<li>Number of Output Channels in Second Convolutional Layer (out_channels2):
Selected from [8, 16, 32], further refining the network’s capability to learn hierarchical spatial patterns.</li>
<li>Kernel Size:
Kernel size impacts the spatial context the model considers when learning features. We considered kernel sizes of [3, 5, 7], balancing between capturing detailed local patterns and broader spatial structures.</li>
<li>Fully Connected Layer Size:
The number of neurons in the fully connected layer was chosen from [32, 64, 128], directly influencing the model’s ability to integrate learned spatial features into higher-level abstractions suitable for classification.</li>
</ul></li>
</ol>
<p>The Bayesian optimization was performed over 100 trials, systematically exploring these hyperparameters.
Each trial evaluated a distinct combination of parameters based on validation accuracy.
The final selection of hyperparameters was determined by the combination that produced the highest validation accuracy,
ensuring the CNN model’s optimal performance on unseen data while minimizing the computational burden associated with hyperparameter tuning.</p>
</div>
<div id="nested-cross-validation" class="section level4 hasAnchor" number="1.4.2.3">
<h4><span class="header-section-number">1.4.2.3</span> Nested Cross-Validation<a href="sm.html#nested-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nested cross-validation <span class="citation">(<a href="#ref-Zhong2023">Zhong, Chalise, and He 2023</a>)</span> involves two cross-validation loops:</p>
<ol style="list-style-type: decimal">
<li>Outer Loop: Evaluates the generalization performance of the model on independent test sets.</li>
<li>Inner Loop: Used for hyperparameter tuning and model selection within each training fold.</li>
</ol>
<p>We use 5 folds of outer loop and 5 folds of inner loop.</p>
</div>
<div id="epochs-and-early-stopping" class="section level4 hasAnchor" number="1.4.2.4">
<h4><span class="header-section-number">1.4.2.4</span> Epochs and Early Stopping<a href="sm.html#epochs-and-early-stopping" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Training was set to a maximum of 35 epochs, with early stopping criteria implemented, patience of 6 epochs without improvement,
to prevent overfitting and reduce training time.</p>
</div>
</div>
<div id="predicting-technique" class="section level3 hasAnchor" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Predicting Technique<a href="sm.html#predicting-technique" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ensemble-learning" class="section level4 hasAnchor" number="1.4.3.1">
<h4><span class="header-section-number">1.4.3.1</span> Ensemble Learning<a href="sm.html#ensemble-learning" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ensemble learning <span class="citation">(<a href="#ref-Dietterich2002">Dietterich et al. 2002</a>)</span> combines predictions from multiple models to enhance predictive performance.
In this case, multiple CNN models trained with different initial conditions.
A deep ensemble of 30 independently trained CNN models, each initialized with different random weights, is utilized.</p>
<p>Predictions from individual CNN models are aggregated using a weighted averaging method, where each model’s contribution is proportional to its validation performance.
This enhances robustness, reduces prediction uncertainty, and provides stable and reliable classification results by capturing a wider range of atmospheric variability.</p>
</div>
<div id="transitional-smoothing" class="section level4 hasAnchor" number="1.4.3.2">
<h4><span class="header-section-number">1.4.3.2</span> Transitional Smoothing<a href="sm.html#transitional-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to the definition, a HB CT must last at least three days <span class="citation">(<a href="#ref-Hess1952">Hess and Brezowsky 1952</a>)</span> to represent a stable atmospheric pattern.
Without enforcing this constraint, the raw neural network predictions may contain short, noisy transitions that are meteorologically implausible.
Thus, transition smoothing is necessary to:</p>
<ol style="list-style-type: decimal">
<li>Remove unrealistic, very short-lived classifications.</li>
<li>Produce physically consistent and stable time series of HB CTs.</li>
<li>Ensure that predictions align with domain-specific expectations.</li>
</ol>
<p>According to the original paper:</p>
<ol style="list-style-type: decimal">
<li>Step 1: Identify all transitions where the predicted HB CT lasts fewer than three days.</li>
<li>Step 2: Check neighborhood consistency:
<ul>
<li>If the HB CT before and after the short transition is the same, assign this type to the transition days.</li>
</ul></li>
<li>Step 3: If different types occur before and after:
<ul>
<li>Compare the predicted probabilities (confidence scores) for each neighboring type.</li>
<li>Assign the transition days to the neighbor with the higher predicted probability (i.e., stronger membership).</li>
</ul></li>
</ol>
<p>This method ensures that short transitions are corrected in a physically meaningful way, based on both label consistency and model confidence.
Since the original code is not available, our transition_smoothing function follows the paper’s logic but introduces minor adaptations for greater robustness and flexibility:</p>
<table>
<caption>Transitional smoothing implementation</caption>
<colgroup>
<col width="11%" />
<col width="27%" />
<col width="29%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Aspect</th>
<th align="left">Paper Description</th>
<th align="left">Our Code Implementation</th>
<th align="left">Reason for Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Minimum duration</td>
<td align="left">3 days fixed</td>
<td align="left">min_duration parameter (default=3)</td>
<td align="left">Makes the method flexible for other settings.</td>
</tr>
<tr class="even">
<td align="left">Neighbor block length trust</td>
<td align="left">Not specified clearly</td>
<td align="left">min_neighbor_run_length parameter (default=2)</td>
<td align="left">Ensures smoothing only when neighboring segments are stable enough.</td>
</tr>
<tr class="odd">
<td align="left">Handling first and last segments</td>
<td align="left">Implicitly ignored</td>
<td align="left">Explicitly handled</td>
<td align="left">Avoids out-of-bound errors at sequence edges.</td>
</tr>
<tr class="even">
<td align="left">Probability averaging</td>
<td align="left">Single-point comparison</td>
<td align="left">Average probability across transition segment</td>
<td align="left">More robust by considering entire transition region, not a single timestep.</td>
</tr>
<tr class="odd">
<td align="left">Fallback behavior when neighbors are not strong</td>
<td align="left">Not detailed</td>
<td align="left">Fallback to the only trusted neighbor if one side is strong enough</td>
<td align="left">Avoids wrong smoothing when one neighbor is unreliable.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="results" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Results<a href="sm.html#results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="classification-performance" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Classification Performance<a href="sm.html#classification-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="f1-score" class="section level4 hasAnchor" number="1.5.1.1">
<h4><span class="header-section-number">1.5.1.1</span> F1-score<a href="sm.html#f1-score" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The classification performance of our model was evaluated using a confusion matrix, F1-scores per class,
macro F1-score <span class="citation">(<a href="#ref-Opitz2019">Opitz and Burst 2019</a>)</span>, and overall accuracy <span class="citation">(<a href="#ref-Alberg2004">Alberg et al. 2004</a>)</span>, following the approach used in the reference study <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
The overall accuracy achieved by our model on the cross-validation test set is 53.17%, and the macro F1-score is 55.14%.
Among all HB CTs (Appendix Figure <a href="sm.html#fig:f1score">1.9</a>), the best performing classes in terms of F1-score are WZ (70.21), HM (63.7), and HB (62.78).
These types exhibit distinct spatial patterns, aiding CNN identification.
The lowest F1-scores are observed for classes like NA (33.61) and SEZ (44.37).
These are likely due to class imbalance caused by rare occurrence.
Generally, accuracy for each type is quite high, which may imply overfitting.</p>
<p>The confusion matrix (Appendix Figure <a href="sm.html#fig:conf">1.17</a>) shows that most misclassifications occur among HB CTs with similar dynamical structures, consistent with expectations from atmospheric science. Diagonal dominance is visible but moderate, reflecting the challenging nature of this classification task.</p>
<p>Compared to the paper results, which reported an overall accuracy of 41.1% and a macro F1-score of 38.3% <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>,
our model achieves slightly higher overall accuracy and macro F1-score.</p>
<table>
<caption>Metric comparison</caption>
<thead>
<tr class="header">
<th align="left">Metric</th>
<th align="left">Paper (%)</th>
<th align="left">Our Model (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Macro F1-score</td>
<td align="left">38.3</td>
<td align="left">55.1</td>
</tr>
<tr class="even">
<td align="left">Overall accuracy</td>
<td align="left">41.1</td>
<td align="left">53.2</td>
</tr>
</tbody>
</table>
<p>The boxplots of F1-score under each HB CT (Figure <a href="sm.html#fig:box">1.6</a>; Appendix Figure <a href="sm.html#fig:boxpaper">1.13</a>) confirm our conclusion:</p>
<ol style="list-style-type: decimal">
<li>Original study has considerably lower overall F1-scores (around 0.3–0.5), indicating challenges in reliable classification.</li>
<li>Our model demonstrates much higher stability with F1-scores generally between 0.80–0.95, suggesting improved reliability and robustness in identifying circulation patterns.</li>
</ol>
</div>
<div id="rmse" class="section level4 hasAnchor" number="1.5.1.2">
<h4><span class="header-section-number">1.5.1.2</span> RMSE<a href="sm.html#rmse" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To further evaluate the quality of the predictions, the Root-Mean-Square Error (RMSE) between the predicted HB CT composites and the true label composites was calculated for variable SLP.</p>
<p>Equation for the calculation of the RMSE with I being the predicted image (in our case: signature plot of the deep learning classifier) and K being the reference image (in our case: signature plot of the labels).
M are number of rows and N the number of columns
of the pictures to compare.
The RMSE thus compares the pixel-wise values of two images.
A value of zero indicates a perfect match <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>; <a href="#ref-Mueller2020">Mueller et al. 2020</a>)</span>.
<span class="math display">\[\text{RMSE} = \sqrt{\frac{1}{M\times N}\sum_{i=0,j=0}^{M-1,N-1}[I(i,j)-K(i,j)]^2}\]</span></p>
<p>Additionally, RMSEs for false positives and false negatives were computed separately.</p>
<p>The average RMSE for our implementation’s predictions across all HB CTs is 0.88,
while the false positives and false negatives yielded RMSEs of 1.08 and 1.23, respectively.</p>
<table>
<caption>RMSE comparison</caption>
<thead>
<tr class="header">
<th align="left">RMSE Category</th>
<th align="left">Paper</th>
<th align="left">Implementation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Prediction RMSE</td>
<td align="left">0.89</td>
<td align="left">0.74</td>
</tr>
<tr class="even">
<td align="left">False positives RMSE</td>
<td align="left">1.09</td>
<td align="left">1.45</td>
</tr>
<tr class="odd">
<td align="left">False negatives RMSE</td>
<td align="left">1.28</td>
<td align="left">0.69</td>
</tr>
</tbody>
</table>
<p>Our implementation achieves a lower prediction RMSE (0.74) compared to the original paper (0.89) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
This indicates that, on average, the spatial patterns of the correctly predicted HB CTs are more similar to the true labels in our model than in the reference study.</p>
<p>However, the false positives RMSE is much higher (1.45) than in the paper (1.09) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
This suggests that when our implementation wrongly predicts a HB CT,
the resulting spatial pattern is less similar to the true pattern than in the paper.</p>
<p>Our implementation shows a lower false negatives RMSE (0.69) compared to the paper (1.28) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.
This means that when the model misses a true HB CT,
the spatial signature remains relatively closer to the correct pattern than in the paper.</p>
<p>The overall pattern suggests that:</p>
<ol style="list-style-type: decimal">
<li>Our implementation is better at maintaining correct structures when making predictions or missing true types.</li>
<li>However, when making incorrect predictions (false positives), our implementation model tends to produce worse distortions than the model used in the paper.</li>
</ol>
</div>
</div>
<div id="signature-plot-analysis" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Signature Plot Analysis<a href="sm.html#signature-plot-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figure <a href="sm.html#fig:sig">1.3</a> shows the signature plots for four HB CTs selected based on our RMSE results:</p>
<ol style="list-style-type: decimal">
<li>Two HB CTs with lowest RMSE: WZ and TRW (best performance)</li>
<li>Two HB CTs with highest RMSE: NA and HNFA (worst performance)</li>
</ol>
<p>For each HB CT, four different composite plots are displayed:</p>
<ol style="list-style-type: decimal">
<li>Labels: Composite of true labels.</li>
<li>Predictions: Composite of model predictions.</li>
<li>False Positives: Days predicted as the HB CT but labeled differently.</li>
<li>False Negatives: Days labeled as the HB CT but predicted differently.</li>
</ol>
<p>RMSE values are shown below each panel, comparing each composite to the true label composite.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sig"></span>
<img src="work/01-weatherpattern/figures/slp_signature_plots.png" alt="Signature plots of four selected circulation patterns at slp. Column 1: labels showing the indicated HB CT, Column 2: deep ensemble predictions showing the indicated HB CT, Column 3: signature pattern, when the deep ensemble predicts the indicated HB CT while labels state differently, Column 4: labels stating the indicated HB CT while deep ensemble predicts differently. The RMSE values are calculated by comparing the respective signature plot to the signature plot of the labels (column 1)." width="70%" />
<p class="caption">
FIGURE 1.3: Signature plots of four selected circulation patterns at slp. Column 1: labels showing the indicated HB CT, Column 2: deep ensemble predictions showing the indicated HB CT, Column 3: signature pattern, when the deep ensemble predicts the indicated HB CT while labels state differently, Column 4: labels stating the indicated HB CT while deep ensemble predicts differently. The RMSE values are calculated by comparing the respective signature plot to the signature plot of the labels (column 1).
</p>
</div>
<p>Based on our results, we can observe that:</p>
<ol style="list-style-type: decimal">
<li>WZ:
<ul>
<li>The predicted composite closely matches the label pattern (RMSE = 0.25).</li>
<li>False positives and false negatives show moderate RMSE (0.81 and 0.36), indicating stable identification of WZ.</li>
</ul></li>
<li>TRW:
<ul>
<li>Predictions for TRW are also accurate (RMSE = 0.32).</li>
<li>False positives (0.92) and false negatives (0.46) suggest TRW is generally recognized reliably.</li>
</ul></li>
<li>NA:
<ul>
<li>Predictions for NA have high RMSE (2.89), indicating difficulty in capturing the correct structure.</li>
<li>False positives (5.15) show very large errors, and false negatives (0.78) suggest missing NA patterns is common.</li>
</ul></li>
<li>HNFA:
<ul>
<li>Predictions for HNFA also show high RMSE (1.20).</li>
<li>False positives (2.80) and false negatives (1.09) are large, implying HNFA is a difficult type for the model to classify.</li>
</ul></li>
</ol>
<p>Differences from the original paper (Appendix Figure <a href="sm.html#fig:sigpaper">1.10</a>) arise primarily from data variations, model differences, and random initialization.</p>
<p>Although the specific CTs selected differ, the general trend remains consistent with the findings of the paper:</p>
<ol style="list-style-type: decimal">
<li>Some HB CTs are easier to predict (low RMSE), others are harder (high RMSE).</li>
<li>False positives tend to have higher RMSE than correct predictions.</li>
<li>A larger discrepancy in the color distribution indicates a higher complexity of HB CT, and false negatives vary depending on HB CT complexity.</li>
</ol>
<p>Thus, while specific HB CTs differ, our results fundamentally agree with the conclusions of the paper that certain patterns are systematically easier or harder to classify, and signature plots are effective to visualize these tendencies.</p>
</div>
<div id="frequency-distribution-of-hb-cts" class="section level3 hasAnchor" number="1.5.3">
<h3><span class="header-section-number">1.5.3</span> Frequency Distribution of HB CTs<a href="sm.html#frequency-distribution-of-hb-cts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figure <a href="sm.html#fig:count">1.4</a> shows the frequency distribution of the 29 HB CTs, expressed as the average number of days per year for the period 1950–1980.
For each HB CT, the frequency derived from the true labels (blue bars) is compared to the frequency derived from the network predictions (yellow bars).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:count"></span>
<img src="work/01-weatherpattern/figures/daycount.png" alt="Frequency distribution of the 29 HB CTs in number of days per year for the training period 1950–1980 (blue) and for predictions of the CNN (yellow)." width="70%" />
<p class="caption">
FIGURE 1.4: Frequency distribution of the 29 HB CTs in number of days per year for the training period 1950–1980 (blue) and for predictions of the CNN (yellow).
</p>
</div>
<p>Overall, the CNN reliably reproduces observed HB CT frequencies:</p>
<ol style="list-style-type: decimal">
<li>Dominant HB CTs (e.g., WZ, HM) are captured accurately, reflecting robust model learning.</li>
<li>Rarer HB CTs (e.g., NA, SZ) exhibit minor deviations, suggesting challenges in accurately learning patterns due to fewer examples, which may indicate slight overfitting.</li>
</ol>
<p>In comparison with the original study (Appendix Figure <a href="sm.html#fig:countpaper">1.11</a>), despite differences in dataset periods (our study: 1950–1980; original: 1900–1980), frequency patterns remain consistent. Slight discrepancies in rarer HB CTs are likely due to dataset differences, emphasizing the importance of extended or more balanced training datasets for better generalization.</p>
<p>The agreement between the label frequencies and the network predictions, as well as the similarity to the paper’s findings, indicates that our model effectively learns the relative occurrence rates of the different HB CTs.
Overall, the frequency distribution results support the conclusions of the original study, confirming that the network can reliably reproduce the occurrence rates of various HB CTs.</p>
</div>
<div id="future-change" class="section level3 hasAnchor" number="1.5.4">
<h3><span class="header-section-number">1.5.4</span> Future Change<a href="sm.html#future-change" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Figure <a href="sm.html#fig:boxn">1.5</a> and Figure <a href="sm.html#fig:box">1.6</a> show the relative changes in the frequency of occurrence of the 29 HB CTs between the future period (2031–2060) and the historical reference period (1971–2000), for the entire year, winter half-year, and summer half-year, based on 12 climate model realizations.
Figure <a href="sm.html#fig:boxn">1.5</a> is the conclusion directly from predicted results, while Figure <a href="sm.html#fig:box">1.6</a> is obtained after transition smoothing.
Positive values indicate an increase in occurrence; negative values indicate a decrease.
The lower panels show the F1-scores of the classification model ensemble.
Higher F1-scores indicate better classification stability and reliability.
The grouping by wind direction allows visual comparison of performance across different HB CT categories.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxn"></span>
<img src="work/01-weatherpattern/figures/non_s_combined_boxplot.png" alt="Boxplots of frequency change and f1 score without transitional smoothing. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS).  Lower plots illustrate the spread of F1-scores." width="70%" />
<p class="caption">
FIGURE 1.5: Boxplots of frequency change and f1 score without transitional smoothing. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS). Lower plots illustrate the spread of F1-scores.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:box"></span>
<img src="work/01-weatherpattern/figures/combined_boxplot.png" alt="Boxplots of frequency change and f1 score after transitional smoothing. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS).  Lower plots illustrate the spread of F1-scores." width="70%" />
<p class="caption">
FIGURE 1.6: Boxplots of frequency change and f1 score after transitional smoothing. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS). Lower plots illustrate the spread of F1-scores.
</p>
</div>
<p>Without transition smoothing (Figure <a href="sm.html#fig:boxn">1.5</a>):</p>
<ol style="list-style-type: decimal">
<li>The boxplots show relatively smaller spreads for most HB CTs.</li>
<li>Most relative changes are within ±50%.</li>
<li>Fewer extreme outliers are observed, and the whiskers are relatively short.</li>
<li>The overall signal is dominated by noise, making it hard to detect consistent climate change trends.</li>
</ol>
<p>With transition smoothing (Figure <a href="sm.html#fig:box">1.6</a>):</p>
<ol style="list-style-type: decimal">
<li>The boxplots show larger spreads, particularly for rare HB CTs.</li>
<li>Relative changes frequently extend beyond ±50%, and even approach ±100% in some cases.</li>
<li>More extreme outliers appear.</li>
<li>F1-score distributions are lower and broader, indicating less stable classification performance.</li>
</ol>
<p>Overall, transition smoothing, while theoretically beneficial, introduces higher internal variability in our implementation, complicating clear signal identification.
Variability differences from the original study stem from methodological factors (ensemble size, smoothing implementation) and underlying climate model characteristics.</p>
<p>Our findings reaffirm the value of a multi-ensemble approach and careful consideration of methodological choices when projecting future circulation trends,
underscoring the need for robust ensemble analysis techniques to better discern climate-driven circulation changes from internal variability.</p>
<p>The original study (Appendix Figure <a href="sm.html#fig:boxpaper">1.13</a>) shows relatively controlled variability, mostly within ±50% <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>, and fewer extreme outliers, indicating relatively stable and moderate shifts in HB CTs.
Our results (Figure <a href="sm.html#fig:boxn">1.5</a>) exhibit larger variability, particularly notable in specific HB CTs such as NA, SEA, HNFZ, and SZ, with frequency changes frequently exceeding ±50%, even reaching ±100%.</p>
<ol style="list-style-type: decimal">
<li>Entire Year:
<ul>
<li>Original study shows moderate shifts centered around zero, with clear signals for types like WA and SEA <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
<li>Our implementation shows notably higher variability with clear signals (e.g., strong increase in HNZ, HM and significant decreases in HB and NEZ).</li>
</ul></li>
<li>Winter Half-Year:
<ul>
<li>Original study depicts clear moderate increases for WW and HFA with relatively smaller variability <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
<li>Our data demonstrate significant changes with pronounced variability and stronger extremes, especially in HNZ and rare CTs like NA and SZ.</li>
</ul></li>
<li>Summer Half-Year:
<ul>
<li>Original data indicate mild variability and clear, moderate increases and decreases in specific types (e.g., decreases in HNFZ, increases in WA) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
<li>Our results again illustrate increased variability with substantial increases (e.g., HNZ, HM) and decreases (e.g., HB, NEZ).</li>
</ul></li>
</ol>
<p>In both cases, the summer half-year has a greater influence on the entire year, despite the winter half-year showing higher variability.
Rare CTs such as NA and SZ are observed with significant changes.
It would be interesting to analyze how rare conditions evolve,
however, due to the unbalanced data, the results are not very reliable.</p>
<p>Key CT Differences:</p>
<ol style="list-style-type: decimal">
<li>WA (Westerly Anticyclonic):
<ul>
<li>Our results show only slight increases, with less pronounced signals for WA, especially compared to significant changes in other types.</li>
<li>Original study consistently shows WA increasing clearly across all seasons <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
</ul></li>
<li>HNZ (Icelandic High Cyclonic):
<ul>
<li>In our results, HNZ consistently shows marked increases, particularly pronounced in the summer and winter half-years.</li>
<li>Original study presents less dramatic decreasing changes for HNZ, reflecting a critical methodological or scenario-driven difference <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
</ul></li>
<li>NA and SZ (Northerly Anticyclonic and Southerly Cyclonic):
<ul>
<li>Our results exhibit significantly larger variability and extreme reductions in NA, while SZ shows extreme negative changes particularly in summer.</li>
<li>Original study maintains relatively modest decreasing changes for these types <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</li>
</ul></li>
</ol>
<p>The differences in projected frequency changes between our results and the original study primarily stem from:</p>
<ol style="list-style-type: decimal">
<li>Time period difference (2031-2060 vs. 2071-2100).</li>
<li>Scenario differences: CanESM2 model (historical) in our study vs. original SMHI-LENS (SSP3-RCP7.0).</li>
<li>Model and methodological distinctions: Implementation differences (e.g., transitional smoothing, dataset variations, and resolution).</li>
<li>Ensemble size effects: Our smaller ensemble size (12 vs. original 50) could amplify internal variability signals.</li>
</ol>
<p>These differences underline the sensitivity of CT analysis to methodological choices, highlighting the importance of transparent documentation of scenario assumptions and model details to ensure the accurate interpretation and comparability of future climate studies.</p>
</div>
</div>
<div id="conclusion-and-outlook" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Conclusion and Outlook<a href="sm.html#conclusion-and-outlook" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this study, we successfully implemented a CNN-based deep learning approach to classify large-scale CTs over Europe, building upon the established HB framework. Using high-resolution ERA5 data for model training, our method achieved an overall accuracy of 53.17% and a macro F1-score of 55.14%, clearly outperforming traditional classification approaches.</p>
<p>The CNN model effectively learned dominant circulation patterns, yet faced challenges classifying rare or inherently complex CTs. These limitations indicate potential issues of class imbalance and inherent labeling uncertainties associated with manual classifications.
One potential improvement to the statistical analysis would be reducing the number of subdivisions of CTs. Subdividing CT according to the wind direction of the jet stream, for example, could increase the robustness of the results. Additionally, the original study found that the most frequent misclassifications occurred between pairs of anticyclonic and cyclonic circulation types <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>, which could be addressed through refined classification methods. Furthermore, future research should be conducted to quantify human-level errors in labelling to better understand the impacts of manual classification biases.</p>
<p>Besides the primary training session and results shown in this report,
we conducted another model training experiment using a narrower range of hyperparameters.
The results, which are illustrated in the presentation, demonstrated noticeably different classification performance compared to the setup we introduced here.
In particular, I suspect that the size of the fully connected linear layers is the mean reason for this difference. Since in earlier experiments with narrower range of hyperparameters, we set the fully connected layer size as fixed 50 dimensions, however, in the latest optimization round, where more extensive hyperparameter tuning were applied, the model consistently favored a dimension size of 128, which leads to high accuracy for each HB CTs. Therefore, the model shows good performance on the current dataset, it is important to note that this does not necessarily guarantee the absence of overfitting.</p>
<p>Due to limited computational resources, we were unable to perform a more thorough investigation to validate these observations or further optimize the model architecture. Future work should focus on systematically assessing the impact of fully connected layer sizes and further regularization strategies to ensure model robustness and generalization.</p>
<p>The analysis of frequency changes in both our implementation and original paper reveals that for most HB CTs, the changes fall within a range of ±5 days (relatively ±50%) (Appendix Figure <a href="sm.html#fig:boxabs">1.12</a>; Figure <a href="sm.html#fig:box">1.6</a>; Appendix Figure <a href="sm.html#fig:boxpaperabs">1.14</a>; Appendix Figure <a href="sm.html#fig:boxpaper">1.13</a>). In the original study, the most significant changes in frequency were observed in the WA circulation type (Appendix Figure <a href="sm.html#fig:boxpaper">1.13</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>, while in the own-built model, the HM and HNZ circulation types experienced the largest shifts in frequency. Notably, our results differ from previous studies, primarily due to distinct methodological choices such as dataset selection, scenario assumptions, and smoothing techniques. These variations underline the sensitivity of HB CTs analysis and stress the importance of transparent methodological reporting.</p>
<p>When focusing only on the frequency of HB CTs, without considering their duration, it is important to highlight that the duration of a HB CT significantly influences the amplitude of weather extremes. This underscores the need to integrate both frequency and duration for a more comprehensive understanding of weather patterns. Duration of a HB CT impacts the amplitude of a weather extreme.</p>
<p>To further evaluate the uncertainties in frequency changes, it would be beneficial to combine multi-model and single-model ensembles under different forcing scenarios. This approach could help assess the uncertainties arising from various climate models and the assumptions in different forcing scenarios.</p>
<p>For future studies, we recommend quantifying human-level errors in labeling to understand better the impacts of manual classification biases.
Additionally, models that explicitly capture temporal continuity, such as Deep Hidden Markov Models <span class="citation">(<a href="#ref-Yu2015">Yu et al. 2015</a>)</span> or temporal-aware CNN architectures (e.g., ConvLSTM <span class="citation">(<a href="#ref-Moishin2021">Moishin et al. 2021</a>)</span>),
could enhance prediction accuracy by directly modeling the persistence characteristic inherent in circulation patterns <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span>.</p>
</div>
<div id="appendix" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Appendix<a href="sm.html#appendix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="statement" class="section level3 hasAnchor" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Statement<a href="sm.html#statement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The implementation was carried out using Python version 3.9.18.</p>
</div>
<div id="figures" class="section level3 hasAnchor" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> Figures<a href="sm.html#figures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Synoptic patterns of the 29 HB CTs using ERA20C (Figure <a href="sm.html#fig:ERA20C">1.7</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ERA20C"></span>
<img src="work/01-weatherpattern/figures/paper/circulation_types.png" alt="Synoptic patterns of the 29 HB CTs created using ERA-20C data averaged over the period 1900 -1980, showing SLP on the left and z500 on the right side." width="70%" />
<p class="caption">
FIGURE 1.7: Synoptic patterns of the 29 HB CTs created using ERA-20C data averaged over the period 1900 -1980, showing SLP on the left and z500 on the right side.
</p>
</div>
<p>HB CTs (Figure <a href="sm.html#fig:cts">1.8</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cts"></span>
<img src="work/01-weatherpattern/figures/paper/cts.png" alt="HB CTs" width="70%" />
<p class="caption">
FIGURE 1.8: HB CTs
</p>
</div>
<p>F1 score comparison table (Figure <a href="sm.html#fig:f1score">1.9</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:f1score"></span>
<img src="work/01-weatherpattern/figures/f1.png" alt="Macro F1" width="70%" />
<p class="caption">
FIGURE 1.9: Macro F1
</p>
</div>
<p>Signature plots of paper - SLP (Figure <a href="sm.html#fig:sigpaper">1.10</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sigpaper"></span>
<img src="work/01-weatherpattern/figures/paper/slp_signature_plots.png" alt="Signature plots of four selected circulation patterns at slp. Column 1: labels showing the indicated HB CT, Column 2: deep ensemble predictions showing the indicated HB CT, Column 3: signature pattern, when the deep ensemble predicts the indicated HB CT while labels state differently, Column 4: labels stating the indicated HB CT while deep ensemble predicts differently. The RMSE values are calculated by comparing the respective signature plot to the signature plot of the labels (column 1). The four HB CTs are chosen as positive (green) and negative (red) examples." width="70%" />
<p class="caption">
FIGURE 1.10: Signature plots of four selected circulation patterns at slp. Column 1: labels showing the indicated HB CT, Column 2: deep ensemble predictions showing the indicated HB CT, Column 3: signature pattern, when the deep ensemble predicts the indicated HB CT while labels state differently, Column 4: labels stating the indicated HB CT while deep ensemble predicts differently. The RMSE values are calculated by comparing the respective signature plot to the signature plot of the labels (column 1). The four HB CTs are chosen as positive (green) and negative (red) examples.
</p>
</div>
<p>Frequency distribution of paper (Figure <a href="sm.html#fig:countpaper">1.11</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:countpaper"></span>
<img src="work/01-weatherpattern/figures/paper/daycount.png" alt="Frequency distribution of the 29 HB CTs in number of days per year for the training period 1900–1980 (blue) and for predictions of the CNN (yellow)." width="70%" />
<p class="caption">
FIGURE 1.11: Frequency distribution of the 29 HB CTs in number of days per year for the training period 1900–1980 (blue) and for predictions of the CNN (yellow).
</p>
</div>
<p>Boxplot of absolute future change and F1 score of our implementation (Figure <a href="sm.html#fig:boxabs">1.12</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxabs"></span>
<img src="work/01-weatherpattern/figures/boxplot_freq_change_abs.png" alt="Boxplots of frequency change and f1 score. Upper plots show the change in the absolute frequency of occurrence (days) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS).  Lower plots illustrate the spread of F1-scores." width="70%" />
<p class="caption">
FIGURE 1.12: Boxplots of frequency change and f1 score. Upper plots show the change in the absolute frequency of occurrence (days) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS). Lower plots illustrate the spread of F1-scores.
</p>
</div>
<p>Boxplot of future change and F1 score of paper (Figure <a href="sm.html#fig:boxpaper">1.13</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxpaper"></span>
<img src="work/01-weatherpattern/figures/paper/boxplot.png" alt="Boxplots of frequency change and f1 score. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS).  Lower plots illustrate the spread of F1-scores." width="70%" />
<p class="caption">
FIGURE 1.13: Boxplots of frequency change and f1 score. Upper plots show the change in the relative frequency of occurrence (%) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS). Lower plots illustrate the spread of F1-scores.
</p>
</div>
<p>Boxplot of absolute future change and F1 score of paper (Figure <a href="sm.html#fig:boxpaperabs">1.14</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxpaperabs"></span>
<img src="work/01-weatherpattern/figures/paper/boxplot_abs.png" alt="Boxplots of frequency change and f1 score. Upper plots show the change in the absolute relative frequency of occurrence (days) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS).  Lower plots illustrate the spread of F1-scores." width="70%" />
<p class="caption">
FIGURE 1.14: Boxplots of frequency change and f1 score. Upper plots show the change in the absolute relative frequency of occurrence (days) of the HB CTs between the future 2031–2060 and the reference period 1971–2000 for the entire year, the winter half-year (ONDJFM) and the summer half-year (AMJJAS). Lower plots illustrate the spread of F1-scores.
</p>
</div>
<p>RMSE table of our implementation - SLP (Figure <a href="sm.html#fig:rmse">1.15</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rmse"></span>
<img src="work/01-weatherpattern/figures/rmse.png" alt="RMSE - slp" width="70%" />
<p class="caption">
FIGURE 1.15: RMSE - slp
</p>
</div>
<p>RMSE table of paper - SLP (Figure <a href="sm.html#fig:rmsepaper">1.16</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rmsepaper"></span>
<img src="work/01-weatherpattern/figures/paper/rmse.png" alt="RMSE - slp" width="70%" />
<p class="caption">
FIGURE 1.16: RMSE - slp
</p>
</div>
<p>Confusion matrix of our implementation (Figure <a href="sm.html#fig:conf">1.17</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conf"></span>
<img src="work/01-weatherpattern/figures/confusion.png" alt="Confusion matrix" width="70%" />
<p class="caption">
FIGURE 1.17: Confusion matrix
</p>
</div>
<p>Confusion matrix of paper (Figure <a href="sm.html#fig:confpaper">1.18</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:confpaper"></span>
<img src="work/01-weatherpattern/figures/paper/confusion.png" alt="Confusion matrix" width="70%" />
<p class="caption">
FIGURE 1.18: Confusion matrix
</p>
</div>
<p>Full signature plot of our implementation - SLP (Figure <a href="sm.html#fig:sigfull">1.19</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sigfull"></span>
<img src="work/01-weatherpattern/figures/slp_signature_plots_all.png" alt="Signature plot" width="70%" />
<p class="caption">
FIGURE 1.19: Signature plot
</p>
</div>
<p>Full signature plot of paper - SLP (Figure <a href="sm.html#fig:sigfullpaper">1.20</a>) <span class="citation">(<a href="#ref-Mittermeier2022">Mittermeier et al. 2022</a>)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sigfullpaper"></span>
<img src="work/01-weatherpattern/figures/paper/slp_signature_plots_all.png" alt="Signature plot" width="70%" />
<p class="caption">
FIGURE 1.20: Signature plot
</p>
</div>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Alberg2004" class="csl-entry">
Alberg, Anthony J, Ji Wan Park, Brant W Hager, Malcolm V Brock, and Marie Diener-West. 2004. <span>“The Use of <span>‘Overall Accuracy’</span> to Evaluate the Validity of Screening or Diagnostic Tests.”</span> <em>Journal of General Internal Medicine</em> 19 (5p1): 460–65.
</div>
<div id="ref-Baur1944" class="csl-entry">
Baur, F., P. Hess, and H. Nagel. 1944. <em>Kalender Der Großwetterlagen Europas 1881–1939</em>. Bad Homburg: Forschungsinstitut für langfristige Witterungsvorhersage. <a href="https://www.mdpi.com/2073-4441/12/6/1562">https://www.mdpi.com/2073-4441/12/6/1562</a>.
</div>
<div id="ref-Bissolli2001b" class="csl-entry">
Bissolli, Peter. 2001. <span>“Wetterlagen Und Großwetterlagen Im 20. Jahrhundert.”</span> <em>DWD Klimastatusbericht</em>. <a href="https://www.dwd.de/DE/leistungen/klimastatusbericht/publikationen/ksb2001_pdf/04_2001.pdf?__blob=publicationFile&amp;v=1">https://www.dwd.de/DE/leistungen/klimastatusbericht/publikationen/ksb2001_pdf/04_2001.pdf?__blob=publicationFile&amp;v=1</a>.
</div>
<div id="ref-Bissolli2001" class="csl-entry">
Bissolli, Peter, and Elke Dittmann. 2001. <span>“The Objective Weather Type Classification of the German Weather Service and Its Possibilities of Application to Environmental and Meteorological Investigations.”</span> <em>Meteorologische Zeitschrift</em> 10 (4): 253–60. <a href="https://doi.org/10.1127/0941-2948/2001/0010-0253">https://doi.org/10.1127/0941-2948/2001/0010-0253</a>.
</div>
<div id="ref-Dietterich2002" class="csl-entry">
Dietterich, Thomas G et al. 2002. <span>“Ensemble Learning.”</span> <em>The Handbook of Brain Theory and Neural Networks</em> 2 (1): 110–25.
</div>
<div id="ref-ECMWF_ERA5" class="csl-entry">
European Centre for Medium-Range Weather Forecasts. 2017. <span>“<span>ERA5: Data Documentation</span>.”</span> <a href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation">https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation</a>.
</div>
<div id="ref-Friedlingstein2008" class="csl-entry">
Friedlingstein, Olivier Boucher, Mark Webb, Jonathan Gregory, et al. 2008. <span>“A Summary of the CMIP5 Experiment Design.”</span> <a href="https://pcmdi.llnl.gov/mips/cmip5/docs/Taylor_CMIP5_design.pdf?id=96">https://pcmdi.llnl.gov/mips/cmip5/docs/Taylor_CMIP5_design.pdf?id=96</a>.
</div>
<div id="ref-Garnett2023" class="csl-entry">
Garnett, Roman. 2023. <em>Bayesian Optimization</em>. Cambridge University Press.
</div>
<div id="ref-CanESM2" class="csl-entry">
Government of Canada. 2025. <span>“Canadian Climate Data and Scenarios - CanESM2 Predictions.”</span> <a href="https://climate-scenarios.canada.ca/?page=pred-canesm2">https://climate-scenarios.canada.ca/?page=pred-canesm2</a>.
</div>
<div id="ref-Hackel2021" class="csl-entry">
Häckel, Hans. 2021. <em>Meteorologie</em>. 9., vollständig überarbeitete und erweiterte Auflage. Stuttgart: Verlag Eugen Ulmer. <a href="https://katalog.ub.uni-heidelberg.de/titel/68020108">https://katalog.ub.uni-heidelberg.de/titel/68020108</a>.
</div>
<div id="ref-Hess2005katalog" class="csl-entry">
Hess, Paul. 2005. <span>“Katalog Der Grosswetterlagen Europas Nach Paul Hess Und Helmuth Brezowsky:(1881-2004).”</span>
</div>
<div id="ref-Hess1952" class="csl-entry">
Hess, Paul, and Helmuth Brezowsky. 1952. <em>Katalog Der Großwetterlagen Europas</em>. Berichte Des Deutschen Wetterdienstes in Der US-Zone 33. Deutscher Wetterdienst. <a href="https://search.worldcat.org/title/Katalog-der-Grosswetterlagen-Europas/oclc/66852539">https://search.worldcat.org/title/Katalog-der-Grosswetterlagen-Europas/oclc/66852539</a>.
</div>
<div id="ref-Hua2015" class="csl-entry">
Hua, Wenjian, Haishan Chen, Shanlei Sun, and Liming Zhou. 2015. <span>“Assessing Climatic Impacts of Future Land Use and Land Cover Change Projected with the CanESM2 Model.”</span> <em>International Journal of Climatology</em> 35 (12).
</div>
<div id="ref-Mehta2019" class="csl-entry">
Mehta, Smit, Chirag Paunwala, and Bhaumik Vaidya. 2019. <span>“CNN Based Traffic Sign Classification Using Adam Optimizer.”</span> In <em>2019 International Conference on Intelligent Computing and Control Systems (ICCS)</em>, 1293–98. IEEE.
</div>
<div id="ref-Mittermeier2022" class="csl-entry">
Mittermeier, Magdalena, Maximilian Weigert, David Rügamer, Helmut Küchenhoff, and Ralf Ludwig. 2022. <span>“A Deep Learning Based Classification of Atmospheric Circulation Types over Europe: Projection of Future Changes in a CMIP6 Large Ensemble.”</span> <em>Environmental Research Letters</em> 17 (8): 084021. <a href="https://doi.org/10.1088/1748-9326/ac8068">https://doi.org/10.1088/1748-9326/ac8068</a>.
</div>
<div id="ref-Moishin2021" class="csl-entry">
Moishin, Mohammed, Ravinesh C Deo, Ramendra Prasad, Nawin Raj, and Shahab Abdulla. 2021. <span>“Designing Deep-Based Learning Flood Forecast Model with ConvLSTM Hybrid Algorithm.”</span> <em>Ieee Access</em> 9: 50982–93.
</div>
<div id="ref-Mueller2020" class="csl-entry">
Mueller, Markus U, Nikoo Ekhtiari, Rodrigo M Almeida, and Christoph Rieke. 2020. <span>“Super-Resolution of Multispectral Satellite Images Using Convolutional Neural Networks.”</span> <em>arXiv Preprint arXiv:2002.00580</em>.
</div>
<div id="ref-Opitz2019" class="csl-entry">
Opitz, Juri, and Sebastian Burst. 2019. <span>“Macro F1 and Macro F1.”</span> <em>arXiv Preprint arXiv:1911.03347</em>.
</div>
<div id="ref-Ozaki2022" class="csl-entry">
Ozaki, Yoshihiko, Yuki Tanigaki, Shuhei Watanabe, Masahiro Nomura, and Masaki Onishi. 2022. <span>“Multiobjective Tree-Structured Parzen Estimator.”</span> <em>Journal of Artificial Intelligence Research</em> 73: 1209–50.
</div>
<div id="ref-Poli2016" class="csl-entry">
Poli, Paul, Hans Hersbach, Dick Dee, John Siminski, Patrick Laloyaux, Debora Tan, Carole Peubey, et al. 2016. <span>“ERA-20C: An Atmospheric Reanalysis of the Twentieth Century.”</span> <em>Journal of Climate</em> 29 (11): 4083–97. <a href="https://doi.org/10.1175/JCLI-D-15-0556.1">https://doi.org/10.1175/JCLI-D-15-0556.1</a>.
</div>
<div id="ref-Ward2020" class="csl-entry">
Ward, Rachel, Xiaoxia Wu, and Leon Bottou. 2020. <span>“Adagrad Stepsizes: Sharp Convergence over Nonconvex Landscapes.”</span> <em>Journal of Machine Learning Research</em> 21 (219): 1–30.
</div>
<div id="ref-Werner2010" class="csl-entry">
Werner, P. C., and F. W. Gerstengarbe. 2010. <em>Katalog Der Großwetterlagen Europas (1881–2009) Nach Paul Hess Und Helmut Brezowsky</em>. PIK Report 119. Potsdam-Institut für Klimafolgenforschung. <a href="https://www.pik-potsdam.de/en/output/publications/pikreports/.files/pr119.pdf">https://www.pik-potsdam.de/en/output/publications/pikreports/.files/pr119.pdf</a>.
</div>
<div id="ref-Wyser2021" class="csl-entry">
Wyser, Klaus, Torben Koenigk, Ulrich Fladrich, Roberto Fuentes-Franco, Mohammad P. Karami, and Tim Kruschke. 2021. <span>“The SMHI Large Ensemble (SMHI-LENS) with EC-Earth3.3.1.”</span> <em>Geoscientific Model Development</em> 14 (9): 4781–96. <a href="https://doi.org/10.5194/gmd-14-4781-2021">https://doi.org/10.5194/gmd-14-4781-2021</a>.
</div>
<div id="ref-Yu2015" class="csl-entry">
Yu, Dong, Li Deng, Dong Yu, and Li Deng. 2015. <span>“Deep Neural Network-Hidden Markov Model Hybrid Systems.”</span> <em>Automatic Speech Recognition: A Deep Learning Approach</em>, 99–116.
</div>
<div id="ref-Zhong2023" class="csl-entry">
Zhong, Yi, Prabhakar Chalise, and Jianghua He. 2023. <span>“Nested Cross-Validation with Ensemble Feature Selection and Classification Model for High-Dimensional Biological Data.”</span> <em>Communications in Statistics-Simulation and Computation</em> 52 (1): 110–25.
</div>
<div id="ref-Zou2019" class="csl-entry">
Zou, Fangyu, Li Shen, Zequn Jie, Weizhong Zhang, and Wei Liu. 2019. <span>“A Sufficient Condition for Convergences of Adam and Rmsprop.”</span> In <em>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 11127–35.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="causal-discovery---constrain-uncertainties-in-climate-projections.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["book.pdf", "book.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
